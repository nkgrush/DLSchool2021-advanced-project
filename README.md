# DLSchool2021-advanced-project
MIPT DLSchool final project for advanced track. A research of different approaches to transfer learning on DeepLabV3

## Цель
Исследовать различные способы адаптации архитектуры DeepLabV3, предобученной на 3-х канальных RGB изображениях из ImageNet для использования дополнительных каналов для задачи семантической сегментации спутниковых изображений.

## Введение
Трансферное обучение является основным подходом к решению новых задач в машинном обучении, так как предобученные модели часто показывают лучшие результаты, чем модели специально созданные под конкретную задачу, даже если они не используют часть имеющихся данных в связи с архитектурными особенностями (https://www.azavea.com/blog/2017/05/30/deep-learning-on-aerial-imagery/).

## Результаты
В этом исследовании я сравнил следующие техники трансферного обучения:
1. Обучение нижних слоёв на новых каналах с последующей вставкой карт активации в основную модель на различной глубине.
2. Ансамблирование предсказаний моделей, обученных на различных комбинациях каналов, используя геометрическое среднее.
3. Суммирование похожих каналов, для усиления сигнала и замена одного из исходных каналов на усиленный.
4. Сравнение с более простой архитектурой UNet, переписанную под 8 каналов.
5. Сравнение с аугментированными данными.

- Код с экспериментами по каждой задаче приведён в соответствующих ноутбуках .ipynb
- Отчёты доступны на W&B: https://wandb.ai/ctcf/DLSchool2021-project/reportlist
- Веса обученных моделей доступны на Google Drive: https://drive.google.com/drive/folders/1Pbfy8UtBKQ59puMs30npWMJIT2YnqkmP?usp=sharing

## Выводы
- Были протестированы различные подходы.
- Аугментации показали высокую эффективность.
- Среди исследованных способов адаптации DeepLabV3 ансамблирование с помощью геометрического среднего показало самый высокий IoU на валидационной выборке.
- Была обнаружена проблема с baseline реализацией DeepLabV3 в torchvision, которая снизила его показатели по сравнению с UNet, написанным по статье. (см. 1 отчёт)
- Более старая модель, UNet показала наибольшую эфективность.
